
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>ttrmap_tst01</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.4.0/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.4.0/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" />
    <script src="stopinfo/js/data11.js"></script>
    <script src="stopinfo/js/data12.js"></script>
    <script src="stopinfo/js/data21.js"></script>
    <script src="stopinfo/js/data22.js"></script>
<script>
    var map;

    function init() {
        map = L.map('map01', { 
            zoomControl: false
        });
        //鳥取駅
        // var mpoint = [35.493795, 134.225827];

        //青谷駅
        var mpoint = [35.523346, 134.000636];
        map.setView(mpoint, 15);
        L.tileLayer('https://cyberjapandata.gsi.go.jp/xyz/pale/{z}/{x}/{y}.png', {
            attribution: "<a href='https://maps.gsi.go.jp/development/ichiran.html' target='_blank'>地理院タイル(淡色)</a>"
        }).addTo(map);
        L.control.zoom({position:'bottomright'}).addTo(map);
        //---------------------------------------------
        //(1)バス系統svg群
        var route_lines = L.tileLayer('xyz/lbm/{z}/{x}/{y}.svg', {
            minNativeZoom: 13,
            minZoom: 10,
            maxNativeZoom: 13,
            maxZoom: 18,
            attribution: "<a href='https://busroutemap.github.io/tottori/index.html' target='_blank'>busroutemap (CC BY 4.0)</a>"
        }).addTo(map);
        //(2)バス停位置群
        // (2.1)日ノ丸上り
        var markers11 = L.markerClusterGroup();
        var markers12 = L.markerClusterGroup();
        var markers21 = L.markerClusterGroup();
        var markers22 = L.markerClusterGroup();
        for (var num in data11) {
            var pass = data11[num];
            var pos = [pass["緯度"], pass["経度"]];
            var con = pass["バス停名"] +'<'+ pass["上下循環区分"]+'>';
            var pop = L.popup().setContent(con);
            markers11.addLayer(L.marker(pos).bindPopup(pop));
        }
        // (2.2)日ノ丸下り
        for (var num in data12) {
            var pass = data12[num];
            var pos = [pass["緯度"], pass["経度"]];
            var con = pass["バス停名"] +'<'+ pass["上下循環区分"]+'>';
            var pop = L.popup().setContent(con);
            markers12.addLayer(L.marker(pos).bindPopup(pop));
        }
        // (2.3)日交上り
        for (var num in data21) {
            var pass = data21[num];
            var pos = [pass["緯度"], pass["経度"]];
            var con = pass["バス停名"] +'<'+ pass["上下循環区分"]+'>';
            var pop = L.popup().setContent(con);
            markers21.addLayer(L.marker(pos).bindPopup(pop));
        }
        // (2.4)日交下り
        for (var num in data22) {
            var pass = data22[num];
            var pos = [pass["緯度"], pass["経度"]];
            var con = pass["バス停名"] +'<'+ pass["上下循環区分"]+'>';
            var pop = L.popup().setContent(con);
            markers22.addLayer(L.marker(pos).bindPopup(pop));
        }
        map.addLayer(markers11);
        map.addLayer(markers12);
        map.addLayer(markers21);
        map.addLayer(markers22);
        //---------------------------------------------
        // ->markerClusterプラグインを導入。以下例
        // var markers = L.markerClusterGroup();
        // markers.addLayer(L.marker(getRandomLatLng(map)));
        //     // ... Add more layers ...
        // map.addLayer(markers);
        var overlay = {
            "停留所(日ノ丸自動車)(上り)<br>stops(Hinomaru bus)(inbound)<hr>": markers11,
            "停留所(日ノ丸自動車)(下り)<br>stops(Hinomaru bus)(outbound)<hr>": markers12,
            "停留所(日本交通)(上り)<br>stops(Nikko bus)(inbound)<hr>": markers21,
            "停留所(日本交通)(下り)<br>stops(Nikko bus)(outbound)<hr>": markers22,
            "バス経路(ローカル)<br>routes(local bus)<hr>": route_lines
        }
        //layersコントロールのオーバーレイに設定
        L.control.layers(null, overlay).addTo(map);
    }
</script>
</head>
<body onload="init()">
    <div id="map01" style="position:absolute;top:0;left:0;right:0;bottom:0;"></div>
</body>
</html>

